# ML ëª¨ë¸ ì‚¬ìš©í•˜ì—¬ web app ë§Œë“¤ê¸°

[https://github.com/microsoft/ML-For-Beginners/tree/main/3-Web-App](https://github.com/microsoft/ML-For-Beginners/tree/main/3-Web-App) ë¥¼ ë³´ê³ 

UFOê°€ ë³´ê³ ëœ ë‚˜ë¼ë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆëŠ” ì›¹ ì•±ë§Œë“¤ê¸°

- VsCode ì‚¬ìš©

## ë°ì´í„° ì¤€ë¹„/ì‚¬ì „ ì¤€ë¹„

1. ë¨¼ì € í•´ë‹¹ í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ í´ë” ìƒì„±
    1. WebApp í´ë”ë¥¼ ë§Œë“¤ì—ˆìŒ
2. ê·¸ í´ë” ì•ˆì— data, codeì´ë¦„ì˜ í´ë” ìƒì„±
    1. ìœ„ github ë§í¬ì—ì„œ ufos.csv ë¥¼ ë‹¤ìš´ë°›ì•„ data í´ë” ì•ˆì— ë„£ê¸°
3. codeí´ë”ë¡œ ì´ë™ í›„, ë¹ˆ *notebook.ipynb*ë¥¼ ìƒì„± í›„ ì‹¤í–‰
4. ë§Œì•½ í˜„ì¬ ê²½ë¡œê°€ WebAppì´ë©´
    1. vscode í„°ë¯¸ë„ì— `cd code`ë¥¼ ì…ë ¥í•˜ì—¬ code í´ë”ë¡œ ì´ë™

## ë°ì´í„° ì •ë¦¬

1. `pandas`, ì™€Â `numpy`, ufos ìŠ¤í”„ë ˆë“œì‹œíŠ¸ import

```python
import pandas as pd
import numpy as np

ufos = pd.read_csv('./data/ufos.csv')
ufos.head()
```

1. ufos ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ì œëª©ì˜ ì‘ì€ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜ í›„,`Country`Â í•„ë“œê°€ ìœ ë‹ˆí¬ ê°’ì¸ì§€ í™•ì¸

```python
ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})

ufos.Country.unique()
```

1. null ê°’ì„ ë“œë, 1-60ì´ˆ ì‚¬ì´ ëª©ê²©ë§Œ ê°€ì ¸ì™€ ë°ì´í„° ìˆ˜ ì¤„ì´ê¸°

```python
ufos.dropna(inplace=True)

ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]

ufos.info()
```

1. Scikit-learnì˜Â `LabelEncoder`Â ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ Importí•´ì„œ êµ­ê°€ì˜ í…ìŠ¤íŠ¸ ê°’ì„ ìˆ«ìë¡œ ë³€í™˜

```python
from sklearn.preprocessing import LabelEncoder

ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])

ufos.head()
```

## ëª¨ë¸ ë§Œë“¤ê¸°

1. X ë²¡í„°ë¡œ í›ˆë ¨í•  3ê°€ì§€ íŠ¹ì„±`Seconds`,Â `Latitude`Â ì™€Â `Longitude`ë¥¼ ì…ë ¥í•˜ì—¬ y ë²¡í„° êµ­ê°€ id ë°˜í™˜

```python
from sklearn.model_selection import train_test_split

Selected_features = ['Seconds','Latitude','Longitude']

X = ufos[Selected_features]
y = ufos['Country']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
```

1. logistic regressionì„ ì‚¬ìš©í•´ì„œ ëª¨ë¸ì„ í›ˆë ¨

```python
from sklearn.metrics import accuracy_score, classification_report 
from sklearn.linear_model import LogisticRegression
model = LogisticRegression()
model.fit(X_train, y_train)
predictions = model.predict(X_test)

print(classification_report(y_test, predictions))
print('Predicted labels: ', predictions)
print('Accuracy: ', accuracy_score(y_test, predictions))
```

## ëª¨ë¸ pickle

```python
import pickle
model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb'))

model = pickle.load(open('ufo-model.pkl','rb'))
print(model.predict([[50,44,-12]]))
```

## Flask ì•± ë§Œë“¤ê¸°

1. code í´ë”ì— *ufo-model.pkl*Â íŒŒì¼ê³¼Â *notebook.ipynb*Â íŒŒì¼ì´ ìˆì„ ê±°ì„
    1. ê·¸ ì˜†ì— **web-app**ì´ë¼ëŠ” í´ë” í•˜ë‚˜ ìƒì„±
2. web-app í´ë”ë¡œ ì´ë™ í›„, **static, templates** 2ê°œì˜ í´ë” ìƒì„±
    1. static ì•ˆì—ëŠ” css í´ë”ë„ ìƒì„±

ì•„ë§ˆ web-app í´ë”ê°€ ì´ëŸ° êµ¬ì¡°ì¼ ê²ƒì„

```
web-app/
			  static/
					    css/
		    templates/
notebook.ipynb
ufo-model.pkl
```

1. web-app í´ë”ë¡œ ì´ë™ í›„, requirements.txt íŒŒì¼ ìƒì„±
    1. ì´ íŒŒì¼ì„ ë§Œë“¤ì§€ ì•Šìœ¼ë©´ í„°ë¯¸ë„ì—ì„œ `pip install`ë¡œ í•˜ë‚˜í•˜ë‚˜ ê°ê° ë‹¤ìš´ ë°›ì•„ì•¼ ë¨

```
scikit-learn
pandas
numpy
flask
```

1. í„°ë¯¸ë„ì— `cd web-app` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ web-appìœ¼ë¡œ ì´ë™

```python
cd web-app
```

1. í„°ë¯¸ë„ì— `pip install`ì„ ì‚¬ìš©í•˜ì—¬ *requirements.txt*Â ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜

```python
pip install -r requirements.txt
```

1. 3ê°€ì§€ íŒŒì¼ ë” ë§Œë“¤ì–´ì•¼ë¨
    1. web-app í´ë”ì— *app.py* ìƒì„±
    2. static/css í´ë”ì— *styles.css* ìƒì„±
    3. templates í´ë”ì— *index.html* ìƒì„±
2. styles.css ë‚´ìš©

```css
body {
	width: 100%;
	height: 100%;
	font-family: 'Helvetica';
	background: black;
	color: #fff;
	text-align: center;
	letter-spacing: 1.4px;
	font-size: 30px;
}

input {
	min-width: 150px;
}

.grid {
	width: 300px;
	border: 1px solid #2d2d2d;
	display: grid;
	justify-content: center;
	margin: 20px auto;
}

.box {
	color: #fff;
	background: #2d2d2d;
	padding: 12px;
	display: inline-block;
}
```

1. index.html íŒŒì¼ ë‚´ìš©

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}"> 
</head>

<body>
 <div class="grid">

  <div class="box">

  <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>

    <form action="{{ url_for('predict')}}" method="post">
    	<input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />
      <input type="text" name="latitude" placeholder="Latitude" required="required" />
		  <input type="text" name="longitude" placeholder="Longitude" required="required" />
      <button type="submit" class="btn">Predict country where the UFO is seen</button>
    </form>

  
   <p>{{ prediction_text }}</p>

 </div>
</div>

</body>
</html>
```

1. app.py ë‚´ìš©

```python
import numpy as np
from flask import Flask, request, render_template
import pickle

app = Flask(__name__)

model = pickle.load(open("./ufo-model.pkl", "rb"))

@app.route("/")
def home():
    return render_template("index.html")

@app.route("/predict", methods=["POST"])
def predict():

    int_features = [int(x) for x in request.form.values()]
    final_features = [np.array(int_features)]
    prediction = model.predict(final_features)

    output = prediction[0]

    countries = ["Australia", "Canada", "Germany", "UK", "US"]

    return render_template(
        "index.html", prediction_text="Likely country: {}".format(countries[output])
    )

if __name__ == "__main__":
    app.run(debug=True)
```

## íŒŒì¼ êµ¬ì¡°

![Untitled](ML%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%89%E1%85%A1%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%84%8B%E1%85%A7%20web%20app%20%E1%84%86%E1%85%A1%E1%86%AB%E1%84%83%E1%85%B3%E1%86%AF%E1%84%80%E1%85%B5%20e99279f80fb644b1a069416ce92aaae6/Untitled.png)

## ì‹¤í–‰

app.py ì‹¤í–‰ ì‹œ ì›¹ ì„œë²„ê°€ ë¡œì»¬ì—ì„œ ì‹œì‘

1. ì˜ì¡´ì„±ì„ ë¶ˆëŸ¬ì˜¤ê³  ì•± ì‹œì‘
2. ëª¨ë¸ ê°€ì ¸ì˜¤ê¸°
3. index.htmlì„ í™ˆ ë¼ìš°í„°ì— ë Œë”ë§

### **í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰**

![Untitled](ML%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%89%E1%85%A1%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%84%8B%E1%85%A7%20web%20app%20%E1%84%86%E1%85%A1%E1%86%AB%E1%84%83%E1%85%B3%E1%86%AF%E1%84%80%E1%85%B5%20e99279f80fb644b1a069416ce92aaae6/Untitled%201.png)

1. web-app í´ë”ë¡œ ì´ë™
2. app.pyë¥¼ í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰
3. Running on [http://127.0.0.1:5000](http://127.0.0.1:5000/) ë¬¸êµ¬ì—ì„œ ë§í¬ í´ë¦­

![Untitled](ML%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%89%E1%85%A1%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%84%8B%E1%85%A7%20web%20app%20%E1%84%86%E1%85%A1%E1%86%AB%E1%84%83%E1%85%B3%E1%86%AF%E1%84%80%E1%85%B5%20e99279f80fb644b1a069416ce92aaae6/Untitled%202.png)

ë‹¤ìŒê³¼ ê°™ì€ ì°½ì´ ëœ¨ê³ , ê°’ì„ ì…ë ¥í•˜ì—¬ UFO ì¶œëª° ì§€ì—­ ì˜ˆì¸¡ ê°€ëŠ¥

- 1, 1, 123,ìœ¼ë¡œ ì…ë ¥í•˜ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ì˜ˆì¸¡ì„ í•´ì¤Œ

![Untitled](ML%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%89%E1%85%A1%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%84%8B%E1%85%A7%20web%20app%20%E1%84%86%E1%85%A1%E1%86%AB%E1%84%83%E1%85%B3%E1%86%AF%E1%84%80%E1%85%B5%20e99279f80fb644b1a069416ce92aaae6/Untitled%203.png)